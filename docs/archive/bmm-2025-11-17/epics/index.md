# NDX CloudFront Origin Routing - Epic Breakdown

## Table of Contents

- [NDX CloudFront Origin Routing - Epic Breakdown](#table-of-contents)
  - [Overview](./overview.md)
  - [Functional Requirements Inventory](./functional-requirements-inventory.md)
    - [CloudFront Origin Management](./functional-requirements-inventory.md#cloudfront-origin-management)
    - [Cookie-Based Routing Logic](./functional-requirements-inventory.md#cookie-based-routing-logic)
    - [Routing Function Deployment](./functional-requirements-inventory.md#routing-function-deployment)
    - [Cache Behavior Configuration](./functional-requirements-inventory.md#cache-behavior-configuration)
    - [CDK Infrastructure Management](./functional-requirements-inventory.md#cdk-infrastructure-management)
    - [Testing & Validation](./functional-requirements-inventory.md#testing-validation)
    - [Rollback & Safety](./functional-requirements-inventory.md#rollback-safety)
    - [Operational Monitoring](./functional-requirements-inventory.md#operational-monitoring)
  - [Epic Summary](./epic-summary.md)
  - [FR Coverage Map](./fr-coverage-map.md)
  - [Epic 1: CloudFront Origin Infrastructure](./epic-1-cloudfront-origin-infrastructure.md)
    - [Story 1.1: Import Existing CloudFront Distribution in CDK](./epic-1-cloudfront-origin-infrastructure.md#story-11-import-existing-cloudfront-distribution-in-cdk)
    - [Story 1.2: Add New S3 Origin with Origin Access Control](./epic-1-cloudfront-origin-infrastructure.md#story-12-add-new-s3-origin-with-origin-access-control)
    - [Story 1.3: Verify Existing Origins Remain Unchanged](./epic-1-cloudfront-origin-infrastructure.md#story-13-verify-existing-origins-remain-unchanged)
    - [Story 1.4: Deploy CloudFront Infrastructure Changes to AWS](./epic-1-cloudfront-origin-infrastructure.md#story-14-deploy-cloudfront-infrastructure-changes-to-aws)
  - [Epic 2: Cookie-Based Routing Implementation](./epic-2-cookie-based-routing-implementation.md)
    - [Story 2.1: Create CloudFront Function for Cookie Inspection](./epic-2-cookie-based-routing-implementation.md#story-21-create-cloudfront-function-for-cookie-inspection)
    - [Story 2.2: Write Unit Tests for Cookie Router Function](./epic-2-cookie-based-routing-implementation.md#story-22-write-unit-tests-for-cookie-router-function)
    - [Story 2.3: Configure Cache Policy with NDX Cookie Allowlist](./epic-2-cookie-based-routing-implementation.md#story-23-configure-cache-policy-with-ndx-cookie-allowlist)
    - [Story 2.4: Deploy CloudFront Function to CDK Stack](./epic-2-cookie-based-routing-implementation.md#story-24-deploy-cloudfront-function-to-cdk-stack)
    - [Story 2.5: Attach Function to Default Cache Behavior](./epic-2-cookie-based-routing-implementation.md#story-25-attach-function-to-default-cache-behavior)
    - [Story 2.6: Deploy Routing Functionality and Validate](./epic-2-cookie-based-routing-implementation.md#story-26-deploy-routing-functionality-and-validate)
  - [Epic 3: Testing, Validation & Operational Readiness](./epic-3-testing-validation-operational-readiness.md)
    - [Story 3.1: Write CDK Snapshot Tests for CloudFront Configuration](./epic-3-testing-validation-operational-readiness.md#story-31-write-cdk-snapshot-tests-for-cloudfront-configuration)
    - [Story 3.2: Write Fine-Grained Assertion Tests for Critical Properties](./epic-3-testing-validation-operational-readiness.md#story-32-write-fine-grained-assertion-tests-for-critical-properties)
    - [Story 3.3: Create Integration Test for Real AWS Deployment](./epic-3-testing-validation-operational-readiness.md#story-33-create-integration-test-for-real-aws-deployment)
    - [Story 3.4: Document Rollback Procedures](./epic-3-testing-validation-operational-readiness.md#story-34-document-rollback-procedures)
    - [Story 3.5: Update Infrastructure README with Operations Guide](./epic-3-testing-validation-operational-readiness.md#story-35-update-infrastructure-readme-with-operations-guide)
    - [Post-Deployment Validation](./epic-3-testing-validation-operational-readiness.md#post-deployment-validation)
    - [Story 3.6: Create Pre-Deployment Checklist and Validation Script](./epic-3-testing-validation-operational-readiness.md#story-36-create-pre-deployment-checklist-and-validation-script)
  - [FR Coverage Matrix](./fr-coverage-matrix.md)
  - [Epic Story Count Summary](./epic-story-count-summary.md)
  - [Summary](./summary.md)
  - [Overview](./overview.md)
  - [Functional Requirements Inventory - Feature 2](./functional-requirements-inventory-feature-2.md)
    - [Authentication & Session Management (10 FRs)](./functional-requirements-inventory-feature-2.md#authentication-session-management-10-frs)
    - [User Interface - Sign In/Out (5 FRs)](./functional-requirements-inventory-feature-2.md#user-interface-sign-inout-5-frs)
    - [Innovation Sandbox API Integration (9 FRs)](./functional-requirements-inventory-feature-2.md#innovation-sandbox-api-integration-9-frs)
    - [Try Page (/try) (5 FRs)](./functional-requirements-inventory-feature-2.md#try-page-try-5-frs)
    - [Try Sessions Display (8 FRs)](./functional-requirements-inventory-feature-2.md#try-sessions-display-8-frs)
    - [Active Session Management (4 FRs)](./functional-requirements-inventory-feature-2.md#active-session-management-4-frs)
    - [Catalogue Integration (7 FRs)](./functional-requirements-inventory-feature-2.md#catalogue-integration-7-frs)
    - [Try Button & Lease Request Modal (17 FRs)](./functional-requirements-inventory-feature-2.md#try-button-lease-request-modal-17-frs)
    - [Responsive Design & Mobile Support (4 FRs)](./functional-requirements-inventory-feature-2.md#responsive-design-mobile-support-4-frs)
    - [Accessibility (WCAG 2.2) (10 FRs)](./functional-requirements-inventory-feature-2.md#accessibility-wcag-22-10-frs)
  - [Epic Summary - Feature 2](./epic-summary-feature-2.md)
  - [FR Coverage Map - Feature 2](./fr-coverage-map-feature-2.md)
  - [Epic 4: Local Development Infrastructure](./epic-4-local-development-infrastructure.md)
    - [Story 4.1: mitmproxy Setup Documentation](./epic-4-local-development-infrastructure.md#story-41-mitmproxy-setup-documentation)
    - [Story 4.2: Create mitmproxy Addon Script for Conditional Forwarding](./epic-4-local-development-infrastructure.md#story-42-create-mitmproxy-addon-script-for-conditional-forwarding)
    - [Story 4.3: mitmproxy Run Configuration](./epic-4-local-development-infrastructure.md#story-43-mitmproxy-run-configuration)
    - [Story 4.4: System Proxy Configuration Instructions](./epic-4-local-development-infrastructure.md#story-44-system-proxy-configuration-instructions)
    - [Story 4.5: Certificate Trust Setup (HTTPS Interception)](./epic-4-local-development-infrastructure.md#story-45-certificate-trust-setup-https-interception)
    - [Story 4.6: Setup Validation Script](./epic-4-local-development-infrastructure.md#story-46-setup-validation-script)
  - [Epic 5: Authentication Foundation](./epic-5-authentication-foundation.md)
    - [Story 5.1: Sign In/Out Button UI Components](./epic-5-authentication-foundation.md#story-51-sign-inout-button-ui-components)
    - [Story 5.2: Sign In OAuth Redirect Flow](./epic-5-authentication-foundation.md#story-52-sign-in-oauth-redirect-flow)
    - [Story 5.3: JWT Token Extraction from URL](./epic-5-authentication-foundation.md#story-53-jwt-token-extraction-from-url)
    - [Story 5.4: sessionStorage JWT Persistence](./epic-5-authentication-foundation.md#story-54-sessionstorage-jwt-persistence)
    - [Story 5.5: Sign Out Functionality](./epic-5-authentication-foundation.md#story-55-sign-out-functionality)
    - [Story 5.6: API Authorization Header Injection](./epic-5-authentication-foundation.md#story-56-api-authorization-header-injection)
    - [Story 5.7: Authentication Status Check API](./epic-5-authentication-foundation.md#story-57-authentication-status-check-api)
    - [Story 5.8: 401 Unauthorized Response Handling](./epic-5-authentication-foundation.md#story-58-401-unauthorized-response-handling)
    - [Story 5.9: Empty State UI for Unauthenticated /try Page](./epic-5-authentication-foundation.md#story-59-empty-state-ui-for-unauthenticated-try-page)
    - [Story 5.10: Automated Accessibility Tests for Auth UI](./epic-5-authentication-foundation.md#story-510-automated-accessibility-tests-for-auth-ui)
  - [Epic 6: Catalogue Integration & Sandbox Requests](./epic-6-catalogue-integration-sandbox-requests.md)
    - [Story 6.0: UX Review Checkpoint (GATE)](./epic-6-catalogue-integration-sandbox-requests.md#story-60-ux-review-checkpoint-gate)
    - [Story 6.1: Parse "try" Metadata from Product YAML Frontmatter](./epic-6-catalogue-integration-sandbox-requests.md#story-61-parse-try-metadata-from-product-yaml-frontmatter)
    - [Story 6.2: Generate "Try Before You Buy" Tag System](./epic-6-catalogue-integration-sandbox-requests.md#story-62-generate-try-before-you-buy-tag-system)
    - [Story 6.3: Catalogue Tag Filter for "Try Before You Buy"](./epic-6-catalogue-integration-sandbox-requests.md#story-63-catalogue-tag-filter-for-try-before-you-buy)
    - [Story 6.4: "Try this now for 24 hours" Button on Product Pages](./epic-6-catalogue-integration-sandbox-requests.md#story-64-try-this-now-for-24-hours-button-on-product-pages)
    - [Story 6.5: Try Button Authentication Check](./epic-6-catalogue-integration-sandbox-requests.md#story-65-try-button-authentication-check)
    - [Story 6.6: Lease Request Modal Overlay UI](./epic-6-catalogue-integration-sandbox-requests.md#story-66-lease-request-modal-overlay-ui)
    - [Story 6.7: Fetch and Display AUP from Innovation Sandbox API](./epic-6-catalogue-integration-sandbox-requests.md#story-67-fetch-and-display-aup-from-innovation-sandbox-api)
    - [Story 6.8: AUP Checkbox and Continue Button State](./epic-6-catalogue-integration-sandbox-requests.md#story-68-aup-checkbox-and-continue-button-state)
    - [Story 6.9: Submit Lease Request and Handle Responses](./epic-6-catalogue-integration-sandbox-requests.md#story-69-submit-lease-request-and-handle-responses)
    - [Story 6.10: Epic 6-7 Integration Testing](./epic-6-catalogue-integration-sandbox-requests.md#story-610-epic-6-7-integration-testing)
    - [Story 6.11: Automated Accessibility Tests for Catalogue Try UI](./epic-6-catalogue-integration-sandbox-requests.md#story-611-automated-accessibility-tests-for-catalogue-try-ui)
  - [Epic 7: Try Sessions Dashboard](./epic-7-try-sessions-dashboard.md)
    - [Story 7.1: Create /try Page Route and Layout](./epic-7-try-sessions-dashboard.md#story-71-create-try-page-route-and-layout)
    - [Story 7.2: Fetch and Display User Leases](./epic-7-try-sessions-dashboard.md#story-72-fetch-and-display-user-leases)
    - [Story 7.3: Render Sessions Table with GOV.UK Design System](./epic-7-try-sessions-dashboard.md#story-73-render-sessions-table-with-govuk-design-system)
    - [Story 7.4: Status Badge Display with Color Coding](./epic-7-try-sessions-dashboard.md#story-74-status-badge-display-with-color-coding)
    - [Story 7.5: Expiry Date Formatting (Relative and Absolute)](./epic-7-try-sessions-dashboard.md#story-75-expiry-date-formatting-relative-and-absolute)
    - [Story 7.6: Budget Display with Cost Formatting](./epic-7-try-sessions-dashboard.md#story-76-budget-display-with-cost-formatting)
    - [Story 7.7: "Launch AWS Console" Button for Active Sessions](./epic-7-try-sessions-dashboard.md#story-77-launch-aws-console-button-for-active-sessions)
    - [Story 7.8: Remaining Lease Duration Display for Active Sessions](./epic-7-try-sessions-dashboard.md#story-78-remaining-lease-duration-display-for-active-sessions)
    - [Story 7.9: Link to Catalogue Filter from /try Page](./epic-7-try-sessions-dashboard.md#story-79-link-to-catalogue-filter-from-try-page)
    - [Story 7.10: First-Time User Guidance on /try Page](./epic-7-try-sessions-dashboard.md#story-710-first-time-user-guidance-on-try-page)
    - [Story 7.11: AWS SSO Portal URL Configuration](./epic-7-try-sessions-dashboard.md#story-711-aws-sso-portal-url-configuration)
    - [Story 7.12: End-to-End User Journey Validation](./epic-7-try-sessions-dashboard.md#story-712-end-to-end-user-journey-validation)
    - [Story 7.13: Automated Accessibility Tests for Dashboard UI](./epic-7-try-sessions-dashboard.md#story-713-automated-accessibility-tests-for-dashboard-ui)
  - [Epic 8: Accessible & Mobile-Friendly Experience + Brownfield Audit](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md)
    - [Story 8.1: Early Brownfield Accessibility Audit (Parallel with Epic 4)](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-81-early-brownfield-accessibility-audit-parallel-with-epic-4)
    - [Story 8.2: Automated Accessibility Testing in CI Pipeline](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-82-automated-accessibility-testing-in-ci-pipeline)
    - [Story 8.3: Comprehensive WCAG 2.2 Audit for Try Feature UI](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-83-comprehensive-wcag-22-audit-for-try-feature-ui)
    - [Story 8.4: GOV.UK Design System Component Compliance Audit](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-84-govuk-design-system-component-compliance-audit)
    - [Story 8.5: Mobile Responsive Design Validation](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-85-mobile-responsive-design-validation)
    - [Story 8.6: Performance and Security Validation](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-86-performance-and-security-validation)
    - [Story 8.7: Keyboard Navigation Testing](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-87-keyboard-navigation-testing)
    - [Story 8.8: Screen Reader Testing (NVDA/JAWS/VoiceOver)](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-88-screen-reader-testing-nvdajawsvoiceover)
    - [Story 8.9: Focus Management and Visual Focus Indicators](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-89-focus-management-and-visual-focus-indicators)
    - [Story 8.10: Error Messaging Accessibility](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-810-error-messaging-accessibility)
    - [Story 8.11: WCAG 2.2 AA Compliance Certification](./epic-8-accessible-mobile-friendly-experience-brownfield-audit.md#story-811-wcag-22-aa-compliance-certification)
  - [FR Coverage Matrix - Feature 2](./fr-coverage-matrix-feature-2.md)
  - [Epic Story Count Summary - Feature 2](./epic-story-count-summary-feature-2.md)
  - [Summary - Feature 2](./summary-feature-2.md)
